<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset=utf-8>
        <meta name="robots" content="noindex, nofollow">

        <title>Overview | AxS</title>

        <link rel="shortcut icon" href="./resources/images/favicon.ico" type="image/x-icon" />
        <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" />
        <link href="./resources/css/style.css" rel="stylesheet" />
        <!-- <link rel="shortcut icon" type="image/png" href="./resources/favicon.png"/> -->
    </head>

    <body>
        <div class=container>
            <div class=sideBar>
                <div class=sb-header>
                    <div class=sb-header-img></div>
            
                    <div class=sb-header-text>
                        AxS calculator
                        <hr />
                        <a href="#" class="btn btn-sb-menu btn-xs" title="User settings"><i class="far fa-user-circle"></i></a>
                        <a href="./settings.html" class="btn btn-sb-menu btn-xs" title="Settings"><i class="fas fa-cogs"></i></a> 
                    </div>
                </div>
            
                <div class=sb-navigation>
                    <a href="#" class="sb-nav-column"><i class="fas fa-info"></i> Information</a>
                    <a href="./lobbyoverview.html" class="sb-nav-column in"><i class="fas fa-bars"></i> Lobby overview</a>
                    <a href="./createlobby.html" class="sb-nav-column"><i class="far fa-plus-square"></i> Create a lobby</a>
                </div>
            </div>

            <div class=mainContent>
                <!-- <div class=multiplayerLobby>
                    <div class=body>
                        <div class=row>
                            <div class=col-11>
                                <span class=multiplayerId><h1>123456</h1></span>
                                <span class=multiplayerDesc>Team 1 vs Team 2</span>
                            </div>

                            <div class=col-1>
                                <div class=multiplayerClose>
                                    <button type=button class="btn btn-danger">Delete</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class=multiplayerLobby>
                    <div class=body>
                        <div class=row>
                            <div class=col-11>
                                <span class=multiplayerId><h1>123456</h1></span>
                                <span class=multiplayerDesc>Team 1 vs Team 2</span>
                            </div>

                            <div class=col-1>
                                <div class=multiplayerClose>
                                    <button type=button class="btn btn-danger">Delete</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class=multiplayerLobby>
                    <div class=body>
                        <div class=row>
                            <div class=col-11>
                                <span class=multiplayerId><h1>123456</h1></span>
                                <span class=multiplayerDesc>Team 1 vs Team 2</span>
                            </div>

                            <div class=col-1>
                                <div class=multiplayerClose>
                                    <button type=button class="btn btn-danger">Delete</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div> -->
            </div>
        </div>
    </body>

    <script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>
    <script src="./resources/js/jquery-3.3.1.min.js"></script>
    <script src="./resources/js/bootstrap.min.js"></script>
    <script>if (window.module) module = window.module;</script>

    <script>
        const {ipcRenderer, remote} = require('electron');

        $(() => {
            // Send a request to the server to retrieve all saved lobbies
            ipcRenderer.send(`requestSavedLobbies`, true);
            
            // This will be called after the requestSavedLobbies call, it contains all the saved lobbies
            ipcRenderer.on('requestedLobbies', (event, arg) => {
                // Loop through the lobbies
                for(const lobbyId in arg) {
                    const currentLobby = arg[lobbyId].data;

                    $('.mainContent').append(`<div class=multiplayerLobby data-href="${lobbyId}">
                                                <div class=body>
                                                    <div class=row>
                                                        <div class=col-11>
                                                            <span class=multiplayerId><h1>${currentLobby.description}</h1></span>
                                                            <span class=multiplayerDesc>${currentLobby.teamOneName} vs ${currentLobby.teamTwoName}</span>
                                                        </div>

                                                        <div class=col-1>
                                                            <div class=multiplayerClose>
                                                                <button type=button class="btn btn-danger">Delete</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`);
                }
            });

            // When you click on a multiplayer lobby block
            $('.mainContent').on('click', '.multiplayerLobby', function() {
                window.location.href = `./lobbyview.html?id=${$(this).data('href')}`;
            });
        });
    </script>
</html>